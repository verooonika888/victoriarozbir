<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Стратегічна сесія</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;500;600;700;800&family=Playfair+Display:ital,wght@0,400;0,500;0,600;1,400&display=swap" rel="stylesheet">
    
    <!-- Intl-Tel-Input CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/intl-tel-input@18.2.1/build/css/intlTelInput.css">

    <!-- Facebook Pixel Code -->
    <script>
        !function(f,b,e,v,n,t,s)
        {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
        n.callMethod.apply(n,arguments):n.queue.push(arguments)};
        if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
        n.queue=[];t=b.createElement(e);t.async=!0;
        t.src=v;s=b.getElementsByTagName(e)[0];
        s.parentNode.insertBefore(t,s)}(window, document,'script',
        'https://connect.facebook.net/en_US/fbevents.js');
        
        // Ініціалізація вашого ID
        fbq('init', '1230047148487254');
        // Відстеження перегляду сторінки
        fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
        src="https://www.facebook.com/tr?id=1230047148487254&ev=PageView&noscript=1"
    /></noscript>
    <!-- End Facebook Pixel Code -->

    <style>
        /* --- VISUAL STYLE SYSTEM --- */
        :root {
            /* Холодний срібний сірий колір */
            --bg-color: #E8E8E8; 
            --text-main: #1C1917;
        }

        body {
            font-family: 'Manrope', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            -webkit-font-smoothing: antialiased;
        }

        .serif { font-family: 'Playfair Display', serif; }

        /* Світло-сірий срібний колір для тексту */
        .text-light-silver { color: #9CA3AF; }

        /* ЕФЕКТ СРІБНОГО СВІТІННЯ */
        .silver-glow {
            text-shadow: 
                0 0 10px rgba(255, 255, 255, 0.9),
                0 0 20px rgba(163, 163, 163, 0.5),
                0 0 30px rgba(115, 115, 115, 0.3);
        }
        
        /* Buttons */
        .btn-white {
            background-color: white; color: #1C1917; transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            cursor: pointer;
        }
        .btn-white:active { transform: scale(0.98); }

        .btn-dark {
            background-color: #1C1917; color: white; transition: all 0.3s ease;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
            cursor: pointer;
        }
        .btn-dark:active { transform: scale(0.98); }

        /* Inputs */
        .input-field {
            width: 100%; background-color: white; border: 1px solid #E5E5E5; 
            border-radius: 12px; padding: 18px 20px; font-size: 16px; 
            transition: all 0.3s; appearance: none; color: #1C1917;
        }
        .input-field::placeholder { color: #A8A29E; font-weight: 300; }
        .input-field:focus { outline: none; border-color: #1C1917; box-shadow: 0 0 0 1px rgba(28, 25, 23, 0.1); }
        textarea.input-field { border-radius: 16px; }

        /* Error State */
        .input-error { border-color: #EF4444 !important; background-color: #FEF2F2; }
        .error-text { color: #EF4444; font-size: 13px; margin-top: 5px; display: none; font-weight: 500; }
        .length-error { color: #EF4444; font-size: 12px; margin-top: 3px; display: none; margin-left: 2px; }

        /* Radio Button Custom Style */
        input[type="radio"] {
            appearance: none; background-color: #fff; margin: 0; color: #1C1917;
            width: 1.25em; height: 1.25em; border: 1px solid #D6D3D1; border-radius: 50%;
            display: grid; place-content: center; transition: 0.2s all; flex-shrink: 0;
        }
        input[type="radio"]::before {
            content: ""; width: 0.65em; height: 0.65em; border-radius: 50%;
            transform: scale(0); transition: 120ms transform ease-in-out;
            box-shadow: inset 1em 1em #1C1917;
        }
        input[type="radio"]:checked::before { transform: scale(1); }
        input[type="radio"]:checked { border-color: #1C1917; }

        .form-label {
            display: block; font-size: 16px; text-transform: uppercase;
            letter-spacing: 0.05em; color: #44403C; font-weight: 700;
            margin-left: 4px; margin-bottom: 8px;
        }
        @media (min-width: 768px) { .form-label { font-size: 18px; } }

        .iti { width: 100%; }
        .iti__country-list { z-index: 50; border-radius: 12px; border: none; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        
        html { scroll-behavior: smooth; }

        .loader {
            border: 2px solid #333; border-top: 2px solid #fff; border-radius: 50%;
            width: 20px; height: 20px; animation: spin 1s linear infinite; display: inline-block;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="overflow-x-hidden bg-[#E8E8E8]">

    <!-- SCREEN 1: HERO (NO SCROLL, FULL HEIGHT) -->
    <section class="h-[100dvh] w-full flex flex-col relative bg-[#E8E8E8] overflow-hidden">
        
        <!-- ДАТА -->
        <div class="absolute top-6 left-1/2 -translate-x-1/2 z-30 w-max">
            <div class="inline-block border border-[#1C1917]/20 bg-[#1C1917] px-5 py-2 rounded-lg shadow-xl">
                <span class="text-white text-xs md:text-sm font-semibold tracking-wide uppercase">21 лютого</span>
            </div>
        </div>

        <!-- TOP: HEADLINE -->
        <div class="pt-20 px-5 pb-2 md:pt-20 md:px-0 w-full z-20 text-center flex-none">
            <h1 class="serif leading-[1.1] tracking-tight">
                <span class="block text-[32px] md:text-6xl font-medium text-[#1C1917]">
                    <span class="font-bold mr-1">БЕЗКОШТОВНИЙ</span> Груповий розбір
                </span>
                
                <span class="block text-[34px] md:text-6xl italic font-normal text-light-silver mt-1">
                    контенту та візуалу
                </span>
            </h1>

            <p class="font-sans text-sm md:text-lg text-[#1C1917] font-extrabold silver-glow mt-3 leading-relaxed max-w-xs md:max-w-md mx-auto">
                після якого твій профіль нарешті говорить про тебе, виглядає професійно і продає
            </p>
        </div>

        <!-- MIDDLE: IMAGE (FULL WIDTH COVER) -->
        <div class="relative flex-grow w-full z-10 overflow-hidden min-h-0">
            <img src="v1.jpg" alt="Expert" class="w-full h-full object-cover object-top">
            <div class="absolute bottom-0 left-0 w-full h-32 bg-gradient-to-t from-[#E8E8E8] to-transparent pointer-events-none"></div>
        </div>

        <!-- BOTTOM: CTA BUTTON -->
        <div class="w-full z-20 pb-8 pt-4 px-6 text-center bg-[#E8E8E8] relative flex-none">
            <p class="text-[#78716C] mb-3 font-medium text-xs tracking-wider uppercase">
                Щоб прийняти участь, зареєструйся
            </p>
            
            <button onclick="scrollToForm()" class="btn-dark w-full max-w-sm mx-auto px-6 py-4 rounded-xl text-base font-bold tracking-wide shadow-2xl">
                ЗАРЕЄСТРУЙСЯ
            </button>
        </div>

    </section>

    <!-- SCREEN 2: ANKETA -->
    <section id="anketa-section" class="py-20 md:py-24 bg-[#E8E8E8] px-6 border-t border-[#D4D4D4]">
        <div class="container mx-auto max-w-xl">
            
            <div class="text-center mb-10 md:mb-12">
                <h2 class="text-3xl md:text-5xl serif mb-4 text-[#1C1917]">Анкета учасника</h2>
                <p class="text-[#78716C] font-light text-sm md:text-base">Заповніть форму, щоб подати заявку на розбір.</p>
            </div>

            <!-- ДОДАНО novalidate ЩОБ ВИМКНУТИ СТАНДАРТНІ ПІДКАЗКИ БРАУЗЕРА -->
            <form id="mainForm" class="space-y-6 md:space-y-8" novalidate>
                
                <!-- FIELDS (Прибрано minlength, текст помилки змінено) -->
                
                <div class="space-y-2">
                    <label class="form-label">Твоє ім'я</label>
                    <input type="text" name="imya" id="imya" class="input-field" placeholder="Ваше ім'я">
                    <p class="error-text" id="name-error">Ім'я не може містити цифри</p>
                    <p class="length-error">Заповніть це поле</p>
                </div>

                <div class="space-y-2">
                    <label class="form-label">Чим ти займаєшся?</label>
                    <input type="text" name="niche" class="input-field" placeholder="Наприклад: Таргет, Психологія...">
                    <p class="length-error">Заповніть це поле</p>
                </div>

                <div class="space-y-2">
                    <label class="form-label">Які труднощі ти відчуваєш з контентом та візуалом?</label>
                    <textarea name="difficulties" rows="3" class="input-field" placeholder="Опишіть вашу ситуацію..."></textarea>
                    <p class="length-error">Заповніть це поле</p>
                </div>

                <div class="space-y-2">
                    <label class="form-label">Яка твоя мета ведення профілю?</label>
                    <input type="text" name="goal" class="input-field" placeholder="Наприклад: Продаж послуг, особистий бренд...">
                    <p class="length-error">Заповніть це поле</p>
                </div>

                <div class="space-y-2">
                    <label class="form-label">Посилання на соцмережі (Instagram)</label>
                    <input type="text" name="instagram" class="input-field" placeholder="@username">
                    <p class="length-error">Заповніть це поле</p>
                </div>

                <div class="space-y-2">
                    <label class="form-label">Номер телефону для зв'язку</label>
                    <input type="tel" id="phone" name="phone" class="input-field">
                    <p class="error-text" id="phone-error">Некоректний номер</p>
                    <p class="error-text" id="country-error">Реєстрація з цього регіону недоступна</p>
                </div>

                <div class="space-y-2">
                    <label class="form-label">Нік у Telegram</label>
                    <input type="text" name="tg_nick" class="input-field" placeholder="@username">
                    <p class="length-error">Заповніть це поле</p>
                </div>

                <div class="space-y-3 pt-2">
                    <label class="flex items-center gap-3 p-4 border border-[#E5E5E5] rounded-xl bg-white cursor-pointer hover:border-[#1C1917] transition-colors">
                        <input type="radio" name="participation_type" value="audit">
                        <span class="text-[#1C1917] text-lg font-medium">Хочу щоб мене розібрали</span>
                    </label>
                    <label class="flex items-center gap-3 p-4 border border-[#E5E5E5] rounded-xl bg-white cursor-pointer hover:border-[#1C1917] transition-colors">
                        <input type="radio" name="participation_type" value="viewer">
                        <span class="text-[#1C1917] text-lg font-medium">Хочу бути глядачем</span>
                    </label>
                    <p class="length-error" id="radio-error" style="margin-left: 4px;">Заповніть це поле</p>
                </div>

                <div class="pt-4">
                    <button type="submit" class="w-full btn-dark py-5 rounded-2xl font-medium text-lg flex justify-center items-center shadow-lg">
                        <span class="btn-text">ЗАПОВНИТИ АНКЕТУ</span>
                    </button>
                </div>

                <div class="flex gap-3 items-start p-4 rounded-2xl border border-[#D4D4D4] bg-white">
                    <span class="text-[#1C1917] text-xl leading-none mt-1">*</span>
                    <p class="text-[11px] md:text-xs text-[#78716C] leading-relaxed">
                        Обов'язково перевірте правильність вказаних вами даних, оскільки на них буде відправлене запрошення на розбори.
                    </p>
                </div>

            </form>
        </div>
    </section>

    <footer class="py-8 text-center text-[#A8A29E] text-xs bg-[#E8E8E8]">
        <p>&copy; 2025 Всі права захищено.</p>
    </footer>

    <!-- SCRIPTS -->
    <script src="https://cdn.jsdelivr.net/npm/intl-tel-input@18.2.1/build/js/intlTelInput.min.js"></script>
    <script>
        // --- CONFIGURATION ---
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwrHYxuRxw3FWhWwxRGJRiqq81iqROjBLPOBU6iOXBcFSaT6HlQJlgA1jaoHwScWBoM/exec'; 
        
        const TG_CHANNEL_URL = 'https://t.me/victoriameshcheriakova_bot?start=69962c8886b47b455506e8c5'; // <--- Ссылка на канал
        
        const EXCLUDED_COUNTRIES = ['ru', 'by'];
        // ---------------------

        function scrollToForm() {
            document.getElementById('anketa-section').scrollIntoView({ behavior: 'smooth' });
        }

        const input = document.querySelector("#phone");
        const iti = window.intlTelInput(input, {
            initialCountry: "auto",
            geoIpLookup: callback => {
                fetch("https://get.geojs.io/v1/ip/country.json")
                    .then(res => res.json())
                    .then(data => callback(data.country))
                    .catch(() => callback("ua"));
            },
            utilsScript: "https://cdn.jsdelivr.net/npm/intl-tel-input@18.2.1/build/js/utils.js",
            separateDialCode: true,
            autoPlaceholder: "aggressive"
        });

        const form = document.getElementById('mainForm');
        
        form.addEventListener('submit', (e) => {
            e.preventDefault();
            
            // Elements
            const nameInput = document.getElementById('imya');
            const nameError = document.getElementById('name-error');
            const phoneError = document.getElementById('phone-error');
            const countryError = document.getElementById('country-error');
            const radioError = document.getElementById('radio-error');
            const btn = form.querySelector('button');
            const btnText = form.querySelector('.btn-text');

            // Reset Errors
            const allInputs = form.querySelectorAll('input, textarea');
            allInputs.forEach(el => el.classList.remove('input-error'));
            document.querySelectorAll('.error-text, .length-error').forEach(el => el.style.display = 'none');

            let isValid = true;

            // 1. Name Validation (No digits)
            const nameRegex = /\d/;
            if (nameRegex.test(nameInput.value)) {
                nameInput.classList.add('input-error');
                nameError.style.display = 'block';
                isValid = false;
            }

            // 2. Length & Empty Validation
            const textFields = ['imya', 'niche', 'goal', 'difficulties', 'instagram', 'tg_nick'];
            textFields.forEach(fieldName => {
                const el = form.querySelector(`[name="${fieldName}"]`);
                if (el) {
                    const val = el.value.trim();
                    // Якщо пусто АБО менше 3 символів
                    if (val.length < 3) {
                        el.classList.add('input-error');
                        const errorMsg = el.parentElement.querySelector('.length-error');
                        if (errorMsg) errorMsg.style.display = 'block';
                        isValid = false;
                    }
                }
            });

            // 3. Phone Format Validation
            if (!iti.isValidNumber()) {
                input.classList.add('input-error');
                phoneError.style.display = 'block';
                isValid = false;
            }

            // 4. Country Exclusion
            const countryData = iti.getSelectedCountryData();
            if (EXCLUDED_COUNTRIES.includes(countryData.iso2)) {
                input.classList.add('input-error');
                countryError.style.display = 'block';
                isValid = false;
            }

            // 5. Radio Buttons Validation
            const radioButtons = document.querySelectorAll('input[name="participation_type"]');
            let radioChecked = false;
            radioButtons.forEach(rb => {
                if(rb.checked) radioChecked = true;
            });
            if (!radioChecked) {
                if(radioError) radioError.style.display = 'block';
                isValid = false;
            }

            if (!isValid) return;

            const originalText = btnText.innerText;
            btnText.innerHTML = '<span class="loader"></span>';
            btn.disabled = true;

            const formData = new FormData(form);
            const data = {
                sheetName: 'Холодка', 
                imya: formData.get('imya'),
                phone: iti.getNumber(),
                niche: formData.get('niche'),
                goal: formData.get('goal'),
                difficulties: formData.get('difficulties'),
                instagram: formData.get('instagram'),
                tg_nick: formData.get('tg_nick'),
                participation_type: formData.get('participation_type'),
                country: countryData.name,
                utm_source: new URLSearchParams(window.location.search).get('utm_source'),
                utm_medium: new URLSearchParams(window.location.search).get('utm_medium'),
                utm_campaign: new URLSearchParams(window.location.search).get('utm_campaign')
            };

            fetch(GOOGLE_SCRIPT_URL, {
                method: 'POST',
                mode: 'no-cors',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            })
            .then(() => {
                // ТУТ СПРАЦЬОВУЄ ПОДІЯ LEAD (КОНВЕРСІЯ)
                if(typeof fbq !== 'undefined') fbq('track', 'Lead');
                window.location.href = TG_CHANNEL_URL;
            })
            .catch(err => {
                console.error(err);
                alert("Сталася помилка. Спробуйте пізніше.");
                btnText.innerText = originalText;
                btn.disabled = false;
            });
        });
    </script>
</body>
</html>
